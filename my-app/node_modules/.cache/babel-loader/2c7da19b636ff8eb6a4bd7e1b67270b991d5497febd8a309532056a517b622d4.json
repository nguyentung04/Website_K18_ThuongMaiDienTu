{"ast":null,"code":"var _jsxFileName = \"E:\\\\DU-AN-TOT-NGHIEP\\\\Website_K18_ThuongMaiDienTu\\\\my-app\\\\src\\\\pages\\\\Client\\\\Home\\\\component\\\\Reviews\\\\Reviews.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef, useCallback } from \"react\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faStar as faStarSolid, faThumbsUp } from \"@fortawesome/free-solid-svg-icons\";\nimport { faStar as faStarRegular } from \"@fortawesome/free-regular-svg-icons\";\nimport axios from \"axios\";\nimport \"./Reviews.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst BASE_URL = \"http://localhost:3000\";\nconst formatDate = date => {\n  const options = {\n    year: \"numeric\",\n    month: \"long\",\n    day: \"numeric\",\n    hour: \"2-digit\",\n    minute: \"2-digit\"\n  };\n  return new Date(date).toLocaleDateString(\"vi-VN\", options);\n};\nconst Review = ({\n  review,\n  index,\n  handleReplySubmit,\n  toggleReplyForm,\n  toggleReplies,\n  showReplyForm,\n  replyContents,\n  showReplies,\n  setReplyContents,\n  fetchReplies\n}) => {\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"review\",\n    children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n      children: review.username\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 38,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"review-rating\",\n      children: [...Array(5)].map((_, i) => /*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n        icon: i < review.rating ? faStarSolid : faStarRegular,\n        style: {\n          color: \"#d0b349\"\n        }\n      }, i, false, {\n        fileName: _jsxFileName,\n        lineNumber: 41,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 39,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"cmt-rep1\",\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"review-content\",\n        children: review.content\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 49,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"review-date\",\n        children: formatDate(review.created_at)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 50,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"review-actions\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => toggleReplyForm(index),\n        className: \"reply-button\",\n        children: \"Tr\\u1EA3 l\\u1EDDi\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 54,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => {\n          const isShowing = showReplies[index];\n          toggleReplies(index);\n          if (!isShowing) {\n            fetchReplies(review.detail_id, index);\n          }\n        },\n        className: \"show-replies-button\",\n        children: showReplies[index] ? \"Ẩn\" : `${review.replyCount} phản hồi`\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 57,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 7\n    }, this), showReplyForm[index] && /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: e => {\n        e.preventDefault();\n        handleReplySubmit(index, e);\n      },\n      className: \"reply-form\",\n      children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n        className: \"form-control\",\n        placeholder: \"Nh\\u1EADp n\\u1ED9i dung ph\\u1EA3n h\\u1ED3i\",\n        value: replyContents[index] || \"\",\n        onChange: e => setReplyContents({\n          ...replyContents,\n          [index]: e.target.value\n        }),\n        required: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"rep_button\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          className: \"replies_button\",\n          children: \"G\\u1EEDi ph\\u1EA3n h\\u1ED3i\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 9\n    }, this), showReplies[index] && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"replies\",\n      children: Array.isArray(review.replies) && review.replies.length > 0 ? review.replies.map(reply => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"reply\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: reply.username\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"cmt-rep\",\n          children: [\" \", /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"review-content\",\n            children: reply.content\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 102,\n            columnNumber: 43\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"review-date\",\n            children: formatDate(reply.created_at)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 103,\n            columnNumber: 19\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 17\n        }, this)]\n      }, reply.id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 15\n      }, this)) : /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Kh\\xF4ng c\\xF3 ph\\u1EA3n h\\u1ED3i n\\xE0o.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 37,\n    columnNumber: 5\n  }, this);\n};\n_c = Review;\nconst Reviews = ({\n  productId\n}) => {\n  _s();\n  const evaluateRef = useRef(null);\n  const [reviews, setReviews] = useState([]);\n  const [comment, setComment] = useState(\"\");\n  const [userRating, setUserRating] = useState(0);\n  const [replyContents, setReplyContents] = useState({});\n  const [showReplyForm, setShowReplyForm] = useState({});\n  const [showReplies, setShowReplies] = useState({});\n  const [message, setMessage] = useState(\"\");\n  const [loading, setLoading] = useState(true);\n  const userId = JSON.parse(localStorage.getItem(\"userData\"));\n  // .id;\n\n  const fetchReplyCount = async reviewId => {\n    try {\n      const response = await axios.get(`${BASE_URL}/api/product/reviews/reply/count/${reviewId}`);\n      return response.data.replyCount; // Đã thay đổi từ 'count' thành 'replyCount'\n    } catch (error) {\n      console.error(\"Lỗi khi lấy số lượng phản hồi:\", error);\n      return 0; // Trả về 0 nếu có lỗi\n    }\n  };\n  useEffect(() => {\n    const controller = new AbortController();\n    const fetchReviews = async () => {\n      try {\n        const response = await axios.get(`${BASE_URL}/api/product/reviews/${productId}`, {\n          signal: controller.signal\n        });\n        const reviewsWithDetailID = await Promise.all(response.data.map(async review => {\n          const replyCount = await fetchReplyCount(review.id);\n          return {\n            ...review,\n            detail_id: review.id,\n            replyCount: replyCount\n          };\n        }));\n        setReviews(reviewsWithDetailID);\n      } catch (error) {\n        if (error.name !== \"AbortError\") {\n          setMessage(\"Lỗi khi lấy dữ liệu đánh giá\");\n        }\n      } finally {\n        setLoading(false);\n      }\n    };\n    fetchReviews();\n    return () => {\n      controller.abort();\n    };\n  }, [productId]);\n  useEffect(() => {\n    if (message) {\n      const timer = setTimeout(() => setMessage(\"\"), 3000);\n      return () => clearTimeout(timer);\n    }\n  }, [message]);\n  const handleSubmit = useCallback(async e => {\n    e.preventDefault();\n    if (!comment || userRating === 0) {\n      setMessage(\"Vui lòng nhập nội dung và chọn đánh giá.\");\n      return;\n    }\n    const newReview = {\n      product_id: productId,\n      user_id: userId,\n      content: comment,\n      rating: userRating\n    };\n    try {\n      const response = await axios.post(`${BASE_URL}/api/product/reviews/${productId}`, newReview);\n      const replyCount = await fetchReplyCount(response.data.id);\n      setReviews(prev => [{\n        ...response.data,\n        replyCount: replyCount\n      }, ...prev]);\n      setComment(\"\");\n      setUserRating(0);\n    } catch (error) {\n      console.error(\"Lỗi khi gửi đánh giá:\", error);\n      setMessage(\"Có lỗi xảy ra khi gửi đánh giá.\");\n    }\n  }, [comment, userRating, productId, userId]);\n  const handleUserRatingClick = useCallback(index => {\n    setUserRating(index + 1);\n  }, []);\n  const toggleReplyForm = useCallback(index => {\n    setShowReplyForm(prev => ({\n      ...prev,\n      [index]: !prev[index]\n    }));\n  }, []);\n  const handleReplySubmit = useCallback(async (index, e) => {\n    e.preventDefault();\n    const replyContent = replyContents[index];\n    if (!replyContent) {\n      setMessage(\"Vui lòng nhập nội dung phản hồi.\");\n      return;\n    }\n    if (index < 0 || index >= reviews.length) {\n      setMessage(\"Lỗi: Chỉ số phản hồi không hợp lệ.\");\n      return;\n    }\n    const reviewToReply = reviews[index];\n    const detail_id = reviewToReply ? reviewToReply.detail_id : undefined;\n    if (!detail_id) {\n      setMessage(\"Lỗi: Không tìm thấy detail_id.\");\n      return;\n    }\n    try {\n      const reply = {\n        user_id: userId,\n        content: replyContent,\n        detail_id: detail_id\n      };\n      const response = await axios.post(`${BASE_URL}/api/product/reviews/reply/${detail_id}`, reply);\n\n      // Cập nhật số lượng phản hồi tại đây\n      const newReplyCount = reviewToReply.replyCount + 1; // Tăng số lượng phản hồi lên 1\n\n      setReviews(prev => prev.map((review, i) => i === index ? {\n        ...review,\n        replies: [...(review.replies || []), response.data],\n        replyCount: newReplyCount // Cập nhật số lượng phản hồi\n      } : review));\n      setReplyContents(prev => ({\n        ...prev,\n        [index]: \"\"\n      }));\n    } catch (error) {}\n  }, [replyContents, reviews, userId]);\n  const toggleReplies = useCallback(index => {\n    setShowReplies(prev => ({\n      ...prev,\n      [index]: !prev[index]\n    }));\n  }, []);\n  const fetchReplies = async (detailId, index) => {\n    try {\n      const response = await axios.get(`${BASE_URL}/api/product/reviews/reply/${detailId}`);\n      if (response.data.success) {\n        const replies = Array.isArray(response.data.replies) ? response.data.replies : [];\n        const newReplyCount = await fetchReplyCount(detailId);\n        setReviews(prev => prev.map((review, i) => i === index ? {\n          ...review,\n          replies: replies,\n          replyCount: newReplyCount\n        } : review));\n      } else {\n        setMessage(response.data.message);\n      }\n    } catch (error) {\n      console.error(\"Lỗi khi lấy phản hồi:\", error);\n      setMessage(\"Có lỗi xảy ra khi lấy phản hồi.\");\n    }\n  };\n  if (loading) return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: \"\\u0110ang t\\u1EA3i...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 322,\n    columnNumber: 23\n  }, this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    ref: evaluateRef,\n    className: \"reviews-section\",\n    children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n      className: \"comment_title\",\n      children: \"\\u0110\\xC1NH GI\\xC1\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 326,\n      columnNumber: 7\n    }, this), message && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"alert\",\n      children: message\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 327,\n      columnNumber: 19\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"comment-box\",\n      children: [/*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleSubmit,\n        className: \"comment-form\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"comment-rating\",\n          children: [...Array(5)].map((_, index) => /*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n            icon: index < userRating ? faStarSolid : faStarRegular,\n            style: {\n              color: \"#d0b349\",\n              cursor: \"pointer\"\n            },\n            onClick: () => handleUserRatingClick(index)\n          }, index, false, {\n            fileName: _jsxFileName,\n            lineNumber: 333,\n            columnNumber: 15\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 331,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-floating comment-content\",\n          children: /*#__PURE__*/_jsxDEV(\"textarea\", {\n            className: \"form-control\",\n            placeholder: \"Nh\\u1EADp n\\u1ED9i dung\",\n            value: comment,\n            onChange: e => setComment(e.target.value),\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 342,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 341,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          className: \"submit_button\",\n          children: \"G\\u1EEDi \\u0111\\xE1nh gi\\xE1\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 350,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 330,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"reviews-list\",\n        children: reviews.map((review, index) => /*#__PURE__*/_jsxDEV(Review, {\n          review: review,\n          index: index,\n          handleReplySubmit: handleReplySubmit,\n          toggleReplyForm: toggleReplyForm,\n          toggleReplies: toggleReplies,\n          showReplyForm: showReplyForm,\n          replyContents: replyContents,\n          setReplyContents: setReplyContents,\n          showReplies: showReplies,\n          fetchReplies: fetchReplies\n        }, review.detail_id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 356,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 354,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 329,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 325,\n    columnNumber: 5\n  }, this);\n};\n_s(Reviews, \"CgR9nTqmxudshwMBDOB/lrDtfSg=\");\n_c2 = Reviews;\nexport default Reviews;\nvar _c, _c2;\n$RefreshReg$(_c, \"Review\");\n$RefreshReg$(_c2, \"Reviews\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useCallback","FontAwesomeIcon","faStar","faStarSolid","faThumbsUp","faStarRegular","axios","jsxDEV","_jsxDEV","BASE_URL","formatDate","date","options","year","month","day","hour","minute","Date","toLocaleDateString","Review","review","index","handleReplySubmit","toggleReplyForm","toggleReplies","showReplyForm","replyContents","showReplies","setReplyContents","fetchReplies","className","children","username","fileName","_jsxFileName","lineNumber","columnNumber","Array","map","_","i","icon","rating","style","color","content","created_at","onClick","isShowing","detail_id","replyCount","onSubmit","e","preventDefault","placeholder","value","onChange","target","required","type","isArray","replies","length","reply","id","_c","Reviews","productId","_s","evaluateRef","reviews","setReviews","comment","setComment","userRating","setUserRating","setShowReplyForm","setShowReplies","message","setMessage","loading","setLoading","userId","JSON","parse","localStorage","getItem","fetchReplyCount","reviewId","response","get","data","error","console","controller","AbortController","fetchReviews","signal","reviewsWithDetailID","Promise","all","name","abort","timer","setTimeout","clearTimeout","handleSubmit","newReview","product_id","user_id","post","prev","handleUserRatingClick","replyContent","reviewToReply","undefined","newReplyCount","detailId","success","ref","cursor","_c2","$RefreshReg$"],"sources":["E:/DU-AN-TOT-NGHIEP/Website_K18_ThuongMaiDienTu/my-app/src/pages/Client/Home/component/Reviews/Reviews.js"],"sourcesContent":["import React, { useState, useEffect, useRef, useCallback } from \"react\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport {\r\n  faStar as faStarSolid,\r\n  faThumbsUp,\r\n} from \"@fortawesome/free-solid-svg-icons\";\r\nimport { faStar as faStarRegular } from \"@fortawesome/free-regular-svg-icons\";\r\nimport axios from \"axios\";\r\nimport \"./Reviews.css\";\r\n\r\nconst BASE_URL = \"http://localhost:3000\";\r\n\r\nconst formatDate = (date) => {\r\n  const options = {\r\n    year: \"numeric\",\r\n    month: \"long\",\r\n    day: \"numeric\",\r\n    hour: \"2-digit\",\r\n    minute: \"2-digit\",\r\n  };\r\n  return new Date(date).toLocaleDateString(\"vi-VN\", options);\r\n};\r\n\r\nconst Review = ({\r\n  review,\r\n  index,\r\n  handleReplySubmit,\r\n  toggleReplyForm,\r\n  toggleReplies,\r\n  showReplyForm,\r\n  replyContents,\r\n  showReplies,\r\n  setReplyContents,\r\n  fetchReplies,\r\n}) => {\r\n  return (\r\n    <div className=\"review\">\r\n      <h3>{review.username}</h3>\r\n      <div className=\"review-rating\">\r\n        {[...Array(5)].map((_, i) => (\r\n          <FontAwesomeIcon\r\n            key={i}\r\n            icon={i < review.rating ? faStarSolid : faStarRegular}\r\n            style={{ color: \"#d0b349\" }}\r\n          />\r\n        ))}\r\n      </div>\r\n      <div className=\"cmt-rep1\">\r\n        <p className=\"review-content\">{review.content}</p>\r\n        <p className=\"review-date\">{formatDate(review.created_at)}</p>\r\n      </div>\r\n\r\n      <div className=\"review-actions\">\r\n        <button onClick={() => toggleReplyForm(index)} className=\"reply-button\">\r\n          Trả lời\r\n        </button>\r\n        <button\r\n          onClick={() => {\r\n            const isShowing = showReplies[index];\r\n            toggleReplies(index);\r\n            if (!isShowing) {\r\n              fetchReplies(review.detail_id, index);\r\n            }\r\n          }}\r\n          className=\"show-replies-button\"\r\n        >\r\n          {showReplies[index] ? \"Ẩn\" : `${review.replyCount} phản hồi`}\r\n        </button>\r\n      </div>\r\n\r\n      {showReplyForm[index] && (\r\n        <form\r\n          onSubmit={(e) => {\r\n            e.preventDefault();\r\n            handleReplySubmit(index, e);\r\n          }}\r\n          className=\"reply-form\"\r\n        >\r\n          <textarea\r\n            className=\"form-control\"\r\n            placeholder=\"Nhập nội dung phản hồi\"\r\n            value={replyContents[index] || \"\"}\r\n            onChange={(e) =>\r\n              setReplyContents({ ...replyContents, [index]: e.target.value })\r\n            }\r\n            required\r\n          />\r\n          <div className=\"rep_button\">\r\n            <button type=\"submit\" className=\"replies_button\">\r\n              Gửi phản hồi\r\n            </button>\r\n          </div>\r\n        </form>\r\n      )}\r\n\r\n      {showReplies[index] && (\r\n        <div className=\"replies\">\r\n          {Array.isArray(review.replies) && review.replies.length > 0 ? (\r\n            review.replies.map((reply) => (\r\n              <div key={reply.id} className=\"reply\">\r\n                <h3>{reply.username}</h3>\r\n                <div className=\"cmt-rep\"> <p className=\"review-content\">{reply.content}</p>\r\n                  <p className=\"review-date\">{formatDate(reply.created_at)}</p>\r\n                </div>\r\n              </div>\r\n            ))\r\n          ) : (\r\n            <p>Không có phản hồi nào.</p>\r\n          )}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nconst Reviews = ({ productId }) => {\r\n  const evaluateRef = useRef(null);\r\n  const [reviews, setReviews] = useState([]);\r\n  const [comment, setComment] = useState(\"\");\r\n  const [userRating, setUserRating] = useState(0);\r\n  const [replyContents, setReplyContents] = useState({});\r\n  const [showReplyForm, setShowReplyForm] = useState({});\r\n  const [showReplies, setShowReplies] = useState({});\r\n  const [message, setMessage] = useState(\"\");\r\n  const [loading, setLoading] = useState(true);\r\n  const userId = JSON.parse(localStorage.getItem(\"userData\"))\r\n  // .id;\r\n\r\n  const fetchReplyCount = async (reviewId) => {\r\n    try {\r\n      const response = await axios.get(\r\n        `${BASE_URL}/api/product/reviews/reply/count/${reviewId}`\r\n      );\r\n      return response.data.replyCount; // Đã thay đổi từ 'count' thành 'replyCount'\r\n    } catch (error) {\r\n      console.error(\"Lỗi khi lấy số lượng phản hồi:\", error);\r\n      return 0; // Trả về 0 nếu có lỗi\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    const controller = new AbortController();\r\n    const fetchReviews = async () => {\r\n      try {\r\n        const response = await axios.get(\r\n          `${BASE_URL}/api/product/reviews/${productId}`,\r\n          {\r\n            signal: controller.signal,\r\n          }\r\n        );\r\n\r\n        const reviewsWithDetailID = await Promise.all(\r\n          response.data.map(async (review) => {\r\n            const replyCount = await fetchReplyCount(review.id);\r\n            return {\r\n              ...review,\r\n              detail_id: review.id,\r\n              replyCount: replyCount,\r\n            };\r\n          })\r\n        );\r\n\r\n        setReviews(reviewsWithDetailID);\r\n      } catch (error) {\r\n        if (error.name !== \"AbortError\") {\r\n          setMessage(\"Lỗi khi lấy dữ liệu đánh giá\");\r\n        }\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n    fetchReviews();\r\n    return () => {\r\n      controller.abort();\r\n    };\r\n  }, [productId]);\r\n\r\n  useEffect(() => {\r\n    if (message) {\r\n      const timer = setTimeout(() => setMessage(\"\"), 3000);\r\n      return () => clearTimeout(timer);\r\n    }\r\n  }, [message]);\r\n\r\n  const handleSubmit = useCallback(\r\n    async (e) => {\r\n      e.preventDefault();\r\n\r\n      if (!comment || userRating === 0) {\r\n        setMessage(\"Vui lòng nhập nội dung và chọn đánh giá.\");\r\n        return;\r\n      }\r\n\r\n      const newReview = {\r\n        product_id: productId,\r\n        user_id: userId,\r\n        content: comment,\r\n        rating: userRating,\r\n      };\r\n\r\n      try {\r\n        const response = await axios.post(\r\n          `${BASE_URL}/api/product/reviews/${productId}`,\r\n          newReview\r\n        );\r\n\r\n        const replyCount = await fetchReplyCount(response.data.id);\r\n           setReviews((prev) => [\r\n          { ...response.data, replyCount: replyCount },\r\n          ...prev,\r\n        ]);\r\n        setComment(\"\");\r\n        setUserRating(0);\r\n      } catch (error) {\r\n        console.error(\"Lỗi khi gửi đánh giá:\", error);\r\n        setMessage(\"Có lỗi xảy ra khi gửi đánh giá.\");\r\n      }\r\n    },\r\n    [comment, userRating, productId, userId]\r\n  );\r\n\r\n  const handleUserRatingClick = useCallback((index) => {\r\n    setUserRating(index + 1);\r\n  }, []);\r\n\r\n  const toggleReplyForm = useCallback((index) => {\r\n    setShowReplyForm((prev) => ({ ...prev, [index]: !prev[index] }));\r\n  }, []);\r\n\r\n  const handleReplySubmit = useCallback(\r\n    async (index, e) => {\r\n      e.preventDefault();\r\n      const replyContent = replyContents[index];\r\n\r\n      if (!replyContent) {\r\n        setMessage(\"Vui lòng nhập nội dung phản hồi.\");\r\n        return;\r\n      }\r\n\r\n      if (index < 0 || index >= reviews.length) {\r\n        setMessage(\"Lỗi: Chỉ số phản hồi không hợp lệ.\");\r\n        return;\r\n      }\r\n\r\n      const reviewToReply = reviews[index];\r\n      const detail_id = reviewToReply ? reviewToReply.detail_id : undefined;\r\n\r\n      if (!detail_id) {\r\n        setMessage(\"Lỗi: Không tìm thấy detail_id.\");\r\n        return;\r\n      }\r\n\r\n\r\n\r\n      try {\r\n        const reply = {\r\n          user_id: userId,\r\n          content: replyContent,\r\n          detail_id: detail_id,\r\n        };\r\n\r\n        const response = await axios.post(\r\n          `${BASE_URL}/api/product/reviews/reply/${detail_id}`,\r\n          reply\r\n        );\r\n\r\n        // Cập nhật số lượng phản hồi tại đây\r\n        const newReplyCount = reviewToReply.replyCount + 1; // Tăng số lượng phản hồi lên 1\r\n\r\n        setReviews((prev) =>\r\n          prev.map((review, i) =>\r\n            i === index\r\n              ? {\r\n                  ...review,\r\n                  replies: [...(review.replies || []), response.data],\r\n                  replyCount: newReplyCount, // Cập nhật số lượng phản hồi\r\n                }\r\n              : review\r\n          )\r\n        );\r\n\r\n        setReplyContents((prev) => ({ ...prev, [index]: \"\" }));\r\n       \r\n      } catch (error) {\r\n       \r\n      }\r\n    },\r\n    [replyContents, reviews, userId]\r\n  );\r\n\r\n  const toggleReplies = useCallback((index) => {\r\n    setShowReplies((prev) => ({ ...prev, [index]: !prev[index] }));\r\n  }, []);\r\n\r\n  const fetchReplies = async (detailId, index) => {\r\n    try {\r\n      const response = await axios.get(\r\n        `${BASE_URL}/api/product/reviews/reply/${detailId}`\r\n      );\r\n\r\n      if (response.data.success) {\r\n        const replies = Array.isArray(response.data.replies)\r\n          ? response.data.replies\r\n          : [];\r\n        const newReplyCount = await fetchReplyCount(detailId);\r\n\r\n        setReviews((prev) =>\r\n          prev.map((review, i) =>\r\n            i === index\r\n              ? { ...review, replies: replies, replyCount: newReplyCount }\r\n              : review\r\n          )\r\n        );\r\n      } else {\r\n        setMessage(response.data.message);\r\n      }} catch (error) {\r\n      console.error(\"Lỗi khi lấy phản hồi:\", error);\r\n      setMessage(\"Có lỗi xảy ra khi lấy phản hồi.\");\r\n    }\r\n  };\r\n\r\n  if (loading) return <div>Đang tải...</div>;\r\n\r\n  return (\r\n    <div ref={evaluateRef} className=\"reviews-section\">\r\n      <h3 className=\"comment_title\">ĐÁNH GIÁ</h3>\r\n      {message && <div className=\"alert\">{message}</div>}\r\n\r\n      <div className=\"comment-box\">\r\n        <form onSubmit={handleSubmit} className=\"comment-form\">\r\n          <div className=\"comment-rating\">\r\n            {[...Array(5)].map((_, index) => (\r\n              <FontAwesomeIcon\r\n                key={index}\r\n                icon={index < userRating ? faStarSolid : faStarRegular}\r\n                style={{ color: \"#d0b349\", cursor: \"pointer\" }}\r\n                onClick={() => handleUserRatingClick(index)}\r\n              />\r\n            ))}\r\n          </div>\r\n          <div className=\"form-floating comment-content\">\r\n            <textarea\r\n              className=\"form-control\"\r\n              placeholder=\"Nhập nội dung\"\r\n              value={comment}\r\n              onChange={(e) => setComment(e.target.value)}\r\n              required\r\n            />\r\n          </div>\r\n          <button type=\"submit\" className=\"submit_button\">\r\n            Gửi đánh giá\r\n          </button>\r\n        </form>\r\n        <div className=\"reviews-list\">\r\n          {reviews.map((review, index) => (\r\n            <Review\r\n              key={review.detail_id}\r\n              review={review}\r\n              index={index}\r\n              handleReplySubmit={handleReplySubmit}\r\n              toggleReplyForm={toggleReplyForm}\r\n              toggleReplies={toggleReplies}\r\n              showReplyForm={showReplyForm}\r\n              replyContents={replyContents}\r\n              setReplyContents={setReplyContents}\r\n              showReplies={showReplies}\r\n              fetchReplies={fetchReplies}\r\n            />\r\n          ))}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Reviews;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}